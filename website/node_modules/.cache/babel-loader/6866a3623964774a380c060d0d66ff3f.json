{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.deregister = exports.register = undefined;\n\nvar _detectPassiveEvents = require(\"detect-passive-events\");\n\nvar _detectPassiveEvents2 = _interopRequireDefault(_detectPassiveEvents);\n\nvar _imgUrlGen = require(\"./imgUrlGen\");\n\nvar _imgSettings = require(\"./imgSettings\");\n\nvar _elValidation = require(\"./elValidation\");\n\nvar _reactDom = require(\"react-dom\");\n\nvar _reactDom2 = _interopRequireDefault(_reactDom);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n} //use capture by default\n\n\nvar eventSettings = true;\n\nif (_detectPassiveEvents2.default.hasSupport === true) {\n  eventSettings = {\n    capture: false,\n    passive: true\n  };\n}\n\nvar listeners = [];\nvar pending = [];\n\nvar register = exports.register = function register(component, callback) {\n  if (listeners.length == 0) {\n    bindEvents();\n  }\n\n  listeners.push({\n    component: component,\n    callback: callback\n  });\n  tryShowImage(component, callback);\n};\n\nvar deregister = exports.deregister = function deregister(id) {\n  removeListener(id);\n};\n\nvar bindEvents = function bindEvents() {\n  window.addEventListener(\"scroll\", checkVisible, eventSettings);\n};\n\nvar checkVisible = function checkVisible() {\n  for (var i = 0; i < listeners.length; ++i) {\n    var listener = listeners[i];\n    tryShowImage(listener.component, listener.callback);\n  }\n\n  purgePending();\n};\n\nvar tryShowImage = function tryShowImage(component, callback) {\n  var node = _reactDom2.default.findDOMNode(component);\n\n  if (node && shouldBeShown(node)) {\n    var _component$props = component.props,\n        id = _component$props.id,\n        width = _component$props.width,\n        height = _component$props.height,\n        fileName = _component$props.fileName,\n        quality = _component$props.quality,\n        altText = _component$props.altText;\n    var image = {\n      id: id,\n      width: width,\n      height: height,\n      fileName: fileName,\n      quality: quality,\n      altText: altText\n    };\n    var nextUrl = (0, _imgUrlGen.getUrl)(node, image);\n    component.setState({\n      src: nextUrl,\n      visible: true\n    });\n    component.forceUpdate();\n    callback(nextUrl);\n    pending.push(component);\n  }\n};\n\nvar shouldBeShown = function shouldBeShown(node) {\n  if (!(0, _elValidation.isValidDOMElement)(node)) {\n    return false;\n  }\n\n  var scrollTop = window.pageYOffset || document.documentElement.scrollTop;\n  var docViewBottom = scrollTop + window.outerHeight;\n  var elemTop = getYPosition(node);\n  return elemTop - _imgSettings.imageSettings.lazyScrollThreshold <= docViewBottom;\n};\n\nvar getYPosition = function getYPosition(node) {\n  var yPosition = 0;\n  var el = node;\n\n  while (el) {\n    yPosition += el.offsetTop - el.scrollTop + el.clientTop;\n    el = el.offsetParent;\n  }\n\n  return yPosition;\n};\n\nvar removeListener = function removeListener(id) {\n  var index = listeners.findIndex(function (x) {\n    return x.component.props.id == id;\n  });\n\n  if (index !== -1) {\n    listeners.splice(index, 1);\n  }\n};\n\nvar purgePending = function purgePending() {\n  pending.forEach(function (component) {\n    removeListener(component.props.id);\n  });\n  pending = [];\n};","map":{"version":3,"sources":["C:/Users/eddie/Desktop/Codes/ACEngWebsite/website/node_modules/react-adaptive-image/dist/utils/clientEvents.js"],"names":["Object","defineProperty","exports","value","deregister","register","undefined","_detectPassiveEvents","require","_detectPassiveEvents2","_interopRequireDefault","_imgUrlGen","_imgSettings","_elValidation","_reactDom","_reactDom2","obj","__esModule","default","eventSettings","hasSupport","capture","passive","listeners","pending","component","callback","length","bindEvents","push","tryShowImage","id","removeListener","window","addEventListener","checkVisible","i","listener","purgePending","node","findDOMNode","shouldBeShown","_component$props","props","width","height","fileName","quality","altText","image","nextUrl","getUrl","setState","src","visible","forceUpdate","isValidDOMElement","scrollTop","pageYOffset","document","documentElement","docViewBottom","outerHeight","elemTop","getYPosition","imageSettings","lazyScrollThreshold","yPosition","el","offsetTop","clientTop","offsetParent","index","findIndex","x","splice","forEach"],"mappings":"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","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.deregister = exports.register = undefined;\n\nvar _detectPassiveEvents = require(\"detect-passive-events\");\n\nvar _detectPassiveEvents2 = _interopRequireDefault(_detectPassiveEvents);\n\nvar _imgUrlGen = require(\"./imgUrlGen\");\n\nvar _imgSettings = require(\"./imgSettings\");\n\nvar _elValidation = require(\"./elValidation\");\n\nvar _reactDom = require(\"react-dom\");\n\nvar _reactDom2 = _interopRequireDefault(_reactDom);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n//use capture by default\nvar eventSettings = true;\n\nif (_detectPassiveEvents2.default.hasSupport === true) {\n    eventSettings = { capture: false, passive: true };\n}\n\nvar listeners = [];\nvar pending = [];\n\nvar register = exports.register = function register(component, callback) {\n    if (listeners.length == 0) {\n        bindEvents();\n    }\n    listeners.push({\n        component: component,\n        callback: callback\n    });\n    tryShowImage(component, callback);\n};\n\nvar deregister = exports.deregister = function deregister(id) {\n    removeListener(id);\n};\n\nvar bindEvents = function bindEvents() {\n    window.addEventListener(\"scroll\", checkVisible, eventSettings);\n};\n\nvar checkVisible = function checkVisible() {\n    for (var i = 0; i < listeners.length; ++i) {\n        var listener = listeners[i];\n        tryShowImage(listener.component, listener.callback);\n    }\n    purgePending();\n};\n\nvar tryShowImage = function tryShowImage(component, callback) {\n    var node = _reactDom2.default.findDOMNode(component);\n    if (node && shouldBeShown(node)) {\n        var _component$props = component.props,\n            id = _component$props.id,\n            width = _component$props.width,\n            height = _component$props.height,\n            fileName = _component$props.fileName,\n            quality = _component$props.quality,\n            altText = _component$props.altText;\n\n        var image = { id: id, width: width, height: height, fileName: fileName, quality: quality, altText: altText };\n        var nextUrl = (0, _imgUrlGen.getUrl)(node, image);\n        component.setState({\n            src: nextUrl,\n            visible: true\n        });\n        component.forceUpdate();\n        callback(nextUrl);\n        pending.push(component);\n    }\n};\n\nvar shouldBeShown = function shouldBeShown(node) {\n    if (!(0, _elValidation.isValidDOMElement)(node)) {\n        return false;\n    }\n    var scrollTop = window.pageYOffset || document.documentElement.scrollTop;\n    var docViewBottom = scrollTop + window.outerHeight;\n    var elemTop = getYPosition(node);\n    return elemTop - _imgSettings.imageSettings.lazyScrollThreshold <= docViewBottom;\n};\n\nvar getYPosition = function getYPosition(node) {\n    var yPosition = 0;\n    var el = node;\n    while (el) {\n        yPosition += el.offsetTop - el.scrollTop + el.clientTop;\n        el = el.offsetParent;\n    }\n\n    return yPosition;\n};\n\nvar removeListener = function removeListener(id) {\n    var index = listeners.findIndex(function (x) {\n        return x.component.props.id == id;\n    });\n    if (index !== -1) {\n        listeners.splice(index, 1);\n    }\n};\n\nvar purgePending = function purgePending() {\n    pending.forEach(function (component) {\n        removeListener(component.props.id);\n    });\n\n    pending = [];\n};"]},"metadata":{},"sourceType":"script"}